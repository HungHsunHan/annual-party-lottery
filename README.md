# 公司尾牙抽獎系統

一個可打包成獨立執行檔的雙視窗抽獎系統，專為公司尾牙活動設計。

## 功能特色

- 🎰 **雙視窗架構**：後台控制 + 前台投影畫面
- 📊 **Excel 匯入匯出**：人員名單、獎項名單、中獎名單
- 🎨 **自訂素材**：Logo、背景、音效可自行更換
- 💾 **自動備份**：每次確認中獎自動存檔
- 📸 **快照功能**：支援「時光倒流」還原狀態
- 🎯 **靈活抽獎**：逐一抽 / 一次全抽 / 自訂數量
- ✨ **動態特效**：抽獎動畫、紙花慶祝效果

## 快速開始

### 開發模式

```bash
# 安裝依賴
npm install

# 啟動開發伺服器（會同時開啟兩個視窗）
npm run dev
```

### 打包執行檔

```bash
# 打包成執行檔
npm run electron:build
```

打包完成後，執行檔會在 `release` 資料夾內。

## Excel 格式說明

> [!IMPORTANT]
> 為確保匯入成功，請務必遵守以下格式與命名規範。

### 支援的檔案格式

| 格式 | 副檔名 | 說明 |
|------|--------|------|
| Excel 2007+ | `.xlsx` | ✅ **建議使用** |
| Excel 97-2003 | `.xls` | ✅ 支援匯入 |

> [!TIP]
> 檔名可以自訂，例如 `2024尾牙人員.xlsx`、`獎項清單.xlsx` 等皆可匯入。

---

### 人員名單

#### 必要欄位（第一列必須是標題列）

| 欄位名稱 | 替代名稱（英文） | 必填 | 說明 |
|---------|-----------------|------|------|
| 部門 | department | ❌ 選填 | 員工部門名稱 |
| 職稱 | title | ❌ 選填 | 員工職稱 |
| 姓名 | name | ✅ **必填** | 員工姓名（不可為空） |

#### 範例資料

| 部門 | 職稱 | 姓名 |
|------|------|------|
| 研發部 | 工程師 | 王小明 |
| 行銷部 | 經理 | 李小華 |
| 財務部 | 會計 | 張小美 |

> [!NOTE]
> - 系統會讀取 **第一個工作表 (Sheet)**
> - 標題列可使用中文或英文，但必須**完全相符**（區分大小寫）
> - 姓名欄位為空的資料列會被自動忽略

---

### 獎項名單

#### 必要欄位（第一列必須是標題列）

| 欄位名稱 | 替代名稱（英文） | 必填 | 說明 |
|---------|-----------------|------|------|
| 獎項名稱 | prize 或 name | ✅ **必填** | 獎品名稱 |
| 數量 | quantity | ❌ 選填 | 獎項數量（預設為 1） |

#### 範例資料

| 獎項名稱 | 數量 |
|---------|------|
| 現金 10000 元 | 1 |
| iPhone 15 | 2 |
| 家電禮券 | 5 |

> [!NOTE]
> - 系統會依照 Excel 中的順序匯入獎項
> - 若「數量」欄位為空或無此欄位，預設每獎項數量為 1
> - 獎項名稱為空的資料列會被自動忽略

---

### 常見匯入錯誤

| 錯誤情況 | 原因 | 解決方式 |
|---------|------|---------|
| 匯入後資料為空 | 標題列名稱錯誤 | 確認標題列使用正確名稱（如「姓名」而非「名字」） |
| 部分欄位遺失 | 欄位名稱拼寫錯誤 | 檢查是否有多餘空白或錯字 |
| 無法讀取檔案 | 檔案格式不支援 | 使用 `.xlsx` 或 `.xls` 格式 |
| 資料順序混亂 | 非預期的工作表 | 確認資料在**第一個工作表**中 |

## 操作說明

### 後台控制面板

1. **儀表板**：查看統計資訊、選擇獎項、開始抽獎
2. **獎項管理**：匯入/新增獎項、拖拉調整順序、調整數量
3. **人員名單**：匯入/新增人員、搜尋篩選
4. **中獎名單**：查看/匯出中獎紀錄
5. **設定**：上傳自訂素材、管理快照

### 抽獎流程

1. 匯入人員名單和獎項
2. 選擇要抽的獎項
3. 點擊「開始抽獎」
4. 抽中後可選擇「確認領取」或「放棄重抽」
5. 系統自動記錄並備份

### 快捷鍵

- 側邊欄「建立快照」：儲存當前狀態
- 側邊欄「同步到前台」：手動更新投影畫面

## 技術架構

- **Electron**：桌面應用框架
- **React + TypeScript**：前端 UI
- **Zustand**：狀態管理
- **xlsx**：Excel 讀寫
- **@dnd-kit**：拖拉排序

## 資料儲存位置

備份檔案儲存在應用程式同層的 `backup` 資料夾：
- 開發環境：專案根目錄下的 `backup/`
- 打包後：`exe` 同層的 `backup/`
