# å…¬å¸å°¾ç‰™æŠ½çç³»çµ±

ä¸€å€‹å¯æ‰“åŒ…æˆç¨ç«‹åŸ·è¡Œæª”çš„é›™è¦–çª—æŠ½çç³»çµ±ï¼Œå°ˆç‚ºå…¬å¸å°¾ç‰™æ´»å‹•è¨­è¨ˆã€‚

## åŠŸèƒ½ç‰¹è‰²

- ğŸ° **é›™è¦–çª—æ¶æ§‹**ï¼šå¾Œå°æ§åˆ¶ + å‰å°æŠ•å½±ç•«é¢
- ğŸ“Š **Excel åŒ¯å…¥åŒ¯å‡º**ï¼šäººå“¡åå–®ã€çé …åå–®ã€ä¸­çåå–®
- ğŸ¨ **è‡ªè¨‚ç´ æ**ï¼šLogoã€èƒŒæ™¯ã€éŸ³æ•ˆå¯è‡ªè¡Œæ›´æ›
- ğŸ§© **å‰å°ç•«é¢è¨­å®š**ï¼šæ¨™é¡Œæ–‡æ¡ˆã€é¡¯ç¤ºå€å¡Šã€å€’æ•¸/æ­æ›‰é…ç½®å¯å³æ™‚èª¿æ•´
- ğŸ§² **æ‹–æ‹‰æ’åº**ï¼šçé …å¯æ‹–æ‹‰èª¿æ•´æŠ½çé †åº
- ğŸ’¾ **è‡ªå‹•å‚™ä»½**ï¼šæ¯æ¬¡ç¢ºèªä¸­çè‡ªå‹•å­˜æª”
- ğŸ“¸ **å¿«ç…§åŠŸèƒ½**ï¼šæ”¯æ´ã€Œæ™‚å…‰å€’æµã€é‚„åŸç‹€æ…‹
- ğŸ¯ **éˆæ´»æŠ½ç**ï¼šé€ä¸€æŠ½ / ä¸€æ¬¡å…¨æŠ½ï¼ˆå¯åœ¨é–‹ç™¼è¨­å®šå•Ÿç”¨è‡ªè¨‚æ•¸é‡ï¼‰
- âœ¨ **å‹•æ…‹ç‰¹æ•ˆ**ï¼šæŠ½çå‹•ç•«ã€ç´™èŠ±æ…¶ç¥æ•ˆæœ
- ğŸ§¯ **ä¸­æ–·çºŒæŠ½**ï¼šå•Ÿå‹•æ™‚åµæ¸¬æœªå®Œæˆæ´»å‹•ï¼Œå¯é¸æ“‡çºŒæ¥
- ğŸ” **åå–®æ’å…¥åˆä½µ**ï¼šæ”¯æ´æŠŠé¡å¤–åå–®æ’å…¥ç¾æœ‰æ¸…å–®ä¸¦å»é‡
- ğŸ›ï¸ **æ’é™¤å·²ä¸­ç**ï¼šå…¨åŸŸé è¨­ + å–®çé …å¯åˆ‡æ›æ˜¯å¦æ’é™¤

## å¿«é€Ÿé–‹å§‹

### é–‹ç™¼æ¨¡å¼

```bash
# å®‰è£ä¾è³´
npm install

# å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨ï¼ˆæœƒåŒæ™‚é–‹å•Ÿå…©å€‹è¦–çª—ï¼‰
npm run dev
```

### æ‰“åŒ…åŸ·è¡Œæª”

```bash
# æ‰“åŒ…æˆåŸ·è¡Œæª”
npm run electron:build
```

æ‰“åŒ…å®Œæˆå¾Œï¼ŒåŸ·è¡Œæª”æœƒåœ¨ `release` è³‡æ–™å¤¾å…§ã€‚

## Excel æ ¼å¼èªªæ˜

> [!IMPORTANT]
> ç‚ºç¢ºä¿åŒ¯å…¥æˆåŠŸï¼Œè«‹å‹™å¿…éµå®ˆä»¥ä¸‹æ ¼å¼èˆ‡å‘½åè¦ç¯„ã€‚

### æ”¯æ´çš„æª”æ¡ˆæ ¼å¼

| æ ¼å¼ | å‰¯æª”å | èªªæ˜ |
|------|--------|------|
| Excel 2007+ | `.xlsx` | âœ… **å»ºè­°ä½¿ç”¨** |
| Excel 97-2003 | `.xls` | âœ… æ”¯æ´åŒ¯å…¥ |

> [!TIP]
> æª”åå¯ä»¥è‡ªè¨‚ï¼Œä¾‹å¦‚ `2024å°¾ç‰™äººå“¡.xlsx`ã€`çé …æ¸…å–®.xlsx` ç­‰çš†å¯åŒ¯å…¥ã€‚

---

### äººå“¡åå–®

#### å¿…è¦æ¬„ä½ï¼ˆç¬¬ä¸€åˆ—å¿…é ˆæ˜¯æ¨™é¡Œåˆ—ï¼‰

| æ¬„ä½åç¨± | æ›¿ä»£åç¨±ï¼ˆè‹±æ–‡ï¼‰ | å¿…å¡« | èªªæ˜ |
|---------|-----------------|------|------|
| éƒ¨é–€ | department | âŒ é¸å¡« | å“¡å·¥éƒ¨é–€åç¨± |
| è·ç¨± | title | âŒ é¸å¡« | å“¡å·¥è·ç¨± |
| å§“å | name | âœ… **å¿…å¡«** | å“¡å·¥å§“åï¼ˆä¸å¯ç‚ºç©ºï¼‰ |

#### é€²éšæ¬„ä½ï¼ˆå¯é¸ï¼Œç”¨æ–¼ä¿ç•™ç‹€æ…‹æˆ–å°æ‡‰ï¼‰

| æ¬„ä½åç¨± | æ›¿ä»£åç¨±ï¼ˆè‹±æ–‡ï¼‰ | èªªæ˜ |
|---------|-----------------|------|
| åƒèˆ‡è€…ID | participantId æˆ– id | å”¯ä¸€è­˜åˆ¥å€¼ï¼Œæœªæä¾›æœƒè‡ªå‹•ç”Ÿæˆ |
| å·²ä¸­ç | hasWon | æ”¯æ´ `æ˜¯/å¦`ã€`true/false`ã€`1/0` |

#### ç¯„ä¾‹è³‡æ–™

| éƒ¨é–€ | è·ç¨± | å§“å |
|------|------|------|
| ç ”ç™¼éƒ¨ | å·¥ç¨‹å¸« | ç‹å°æ˜ |
| è¡ŒéŠ·éƒ¨ | ç¶“ç† | æå°è¯ |
| è²¡å‹™éƒ¨ | æœƒè¨ˆ | å¼µå°ç¾ |

> [!NOTE]
> - ç³»çµ±æœƒè®€å– **ç¬¬ä¸€å€‹å·¥ä½œè¡¨ (Sheet)**
> - æ¨™é¡Œåˆ—å¯ä½¿ç”¨ä¸­æ–‡æˆ–è‹±æ–‡ï¼Œä½†å¿…é ˆ**å®Œå…¨ç›¸ç¬¦**ï¼ˆå€åˆ†å¤§å°å¯«ï¼‰
> - å§“åæ¬„ä½ç‚ºç©ºçš„è³‡æ–™åˆ—æœƒè¢«è‡ªå‹•å¿½ç•¥

---

### çé …åå–®

#### å¿…è¦æ¬„ä½ï¼ˆç¬¬ä¸€åˆ—å¿…é ˆæ˜¯æ¨™é¡Œåˆ—ï¼‰

| æ¬„ä½åç¨± | æ›¿ä»£åç¨±ï¼ˆè‹±æ–‡ï¼‰ | å¿…å¡« | èªªæ˜ |
|---------|-----------------|------|------|
| çé …åç¨± | prize æˆ– name | âœ… **å¿…å¡«** | çå“åç¨± |
| æ•¸é‡ | quantity | âŒ é¸å¡« | çé …æ•¸é‡ï¼ˆé è¨­ç‚º 1ï¼‰ |

#### é€²éšæ¬„ä½ï¼ˆå¯é¸ï¼Œç”¨æ–¼ä¿ç•™ç‹€æ…‹æˆ–æ’åºï¼‰

| æ¬„ä½åç¨± | æ›¿ä»£åç¨±ï¼ˆè‹±æ–‡ï¼‰ | èªªæ˜ |
|---------|-----------------|------|
| çé …ID | prizeId æˆ– id | å”¯ä¸€è­˜åˆ¥å€¼ï¼Œæœªæä¾›æœƒè‡ªå‹•ç”Ÿæˆ |
| ç¸½æ•¸é‡ | quantity | èˆ‡ã€Œæ•¸é‡ã€åŒç¾© |
| å·²æŠ½ä¸­æ•¸é‡ | drawnCount | å·²æŠ½ä¸­æ•¸é‡ |
| æ’åºé †ä½ | order | æŠ½çé †åº |
| æ’é™¤å·²ä¸­çè€… | excludeWinners | `æ˜¯/å¦`ï¼Œå–®çé …æ’é™¤è¨­å®š |
| ç‹€æ…‹ | status | `pending / in-progress / incomplete / completed` |

#### ç¯„ä¾‹è³‡æ–™

| çé …åç¨± | æ•¸é‡ |
|---------|------|
| ç¾é‡‘ 10000 å…ƒ | 1 |
| iPhone 15 | 2 |
| å®¶é›»ç¦®åˆ¸ | 5 |

> [!NOTE]
> - ç³»çµ±æœƒä¾ç…§ Excel ä¸­çš„é †åºåŒ¯å…¥çé …
> - è‹¥ã€Œæ•¸é‡ã€æ¬„ä½ç‚ºç©ºæˆ–ç„¡æ­¤æ¬„ä½ï¼Œé è¨­æ¯çé …æ•¸é‡ç‚º 1
> - çé …åç¨±ç‚ºç©ºçš„è³‡æ–™åˆ—æœƒè¢«è‡ªå‹•å¿½ç•¥

---

### å¸¸è¦‹åŒ¯å…¥éŒ¯èª¤

| éŒ¯èª¤æƒ…æ³ | åŸå›  | è§£æ±ºæ–¹å¼ |
|---------|------|---------|
| åŒ¯å…¥å¾Œè³‡æ–™ç‚ºç©º | æ¨™é¡Œåˆ—åç¨±éŒ¯èª¤ | ç¢ºèªæ¨™é¡Œåˆ—ä½¿ç”¨æ­£ç¢ºåç¨±ï¼ˆå¦‚ã€Œå§“åã€è€Œéã€Œåå­—ã€ï¼‰ |
| éƒ¨åˆ†æ¬„ä½éºå¤± | æ¬„ä½åç¨±æ‹¼å¯«éŒ¯èª¤ | æª¢æŸ¥æ˜¯å¦æœ‰å¤šé¤˜ç©ºç™½æˆ–éŒ¯å­— |
| ç„¡æ³•è®€å–æª”æ¡ˆ | æª”æ¡ˆæ ¼å¼ä¸æ”¯æ´ | ä½¿ç”¨ `.xlsx` æˆ– `.xls` æ ¼å¼ |
| è³‡æ–™é †åºæ··äº‚ | éé æœŸçš„å·¥ä½œè¡¨ | ç¢ºèªè³‡æ–™åœ¨**ç¬¬ä¸€å€‹å·¥ä½œè¡¨**ä¸­ |
| ä¸­çåŒ¯å…¥å¤±æ•— | ç„¡æ³•å°æ‡‰çé …æˆ–å¾—çè€… | è«‹å…ˆåŒ¯å…¥äººå“¡åå–®èˆ‡çé …åå–® |

---

### ä¸­çåå–®

> [!NOTE]
> åŒ¯å…¥ä¸­çåå–®å‰ï¼Œéœ€å…ˆåŒ¯å…¥äººå“¡åå–®èˆ‡çé …åå–®ã€‚
> åŒ¯å…¥å¾Œç³»çµ±æœƒä¾ä¸­çè³‡æ–™æ›´æ–°äººå“¡ä¸­çç‹€æ…‹èˆ‡çé …é€²åº¦ã€‚

#### ä¸»è¦æ¬„ä½ï¼ˆç¬¬ä¸€åˆ—å¿…é ˆæ˜¯æ¨™é¡Œåˆ—ï¼‰

| æ¬„ä½åç¨± | æ›¿ä»£åç¨±ï¼ˆè‹±æ–‡ï¼‰ | èªªæ˜ |
|---------|-----------------|------|
| ä¸­çID | winnerId æˆ– id | å”¯ä¸€è­˜åˆ¥å€¼ |
| çé …ID | prizeId | å¯ç”¨æ–¼ç²¾æº–å°æ‡‰çé … |
| çé …åç¨± | prize æˆ– name | å¯ç”¨æ–¼åç¨±å°æ‡‰ |
| å¾—çè€…ID | participantId | å¯ç”¨æ–¼ç²¾æº–å°æ‡‰äººå“¡ |
| å¾—çè€…å§“å | name | è‹¥ç„¡ IDï¼Œæœƒä»¥å§“å/éƒ¨é–€/è·ç¨±æ¯”å° |
| éƒ¨é–€ | department | æ­é…å§“åå¢åŠ è¾¨è­˜åº¦ |
| è·ç¨± | title | æ­é…å§“åå¢åŠ è¾¨è­˜åº¦ |
| ä¸­çæ™‚é–“ | drawnAt | å¯ç‚ºæ—¥æœŸæˆ–æ–‡å­— |
| å·²ç¢ºèª | confirmed | `æ˜¯/å¦`ã€`true/false`ã€`1/0` |

## æ“ä½œèªªæ˜

### å¾Œå°æ§åˆ¶é¢æ¿

1. **å„€è¡¨æ¿**ï¼šæŸ¥çœ‹çµ±è¨ˆè³‡è¨Šã€é¸æ“‡çé …ã€é–‹å§‹æŠ½ç
2. **çé …ç®¡ç†**ï¼šåŒ¯å…¥/æ–°å¢çé …ã€æ‹–æ‹‰èª¿æ•´é †åºã€èª¿æ•´æ•¸é‡
3. **äººå“¡åå–®**ï¼šåŒ¯å…¥/æ–°å¢äººå“¡ã€æœå°‹ç¯©é¸
4. **ä¸­çåå–®**ï¼šæŸ¥çœ‹/åŒ¯å…¥/åŒ¯å‡ºä¸­çç´€éŒ„ã€æ’åºã€åˆªé™¤
5. **è¨­å®š**ï¼šå‰å°ç•«é¢è¨­å®šã€ç´ æä¸Šå‚³ã€å­˜æª”/é‚„åŸã€ç®¡ç†å¿«ç…§

### æŠ½çæµç¨‹

1. åŒ¯å…¥äººå“¡åå–®å’Œçé …
2. é¸æ“‡è¦æŠ½çš„çé …
3. é»æ“Šã€Œé–‹å§‹æŠ½çã€
4. æŠ½ä¸­å¾Œå¯é¸æ“‡ã€Œç¢ºèªé ˜å–ã€æˆ–ã€Œæ”¾æ£„é‡æŠ½ã€
5. ç³»çµ±è‡ªå‹•è¨˜éŒ„ä¸¦å‚™ä»½

### å‰å°ç•«é¢è¨­å®š

- **ä¸»è¦–è¦º**ï¼šæ¨™é¡Œ/å‰¯æ¨™ã€Logo é¡¯ç¤ºã€çé …é è¦½èˆ‡é€²åº¦
- **å€’æ•¸ç•«é¢**ï¼šæ–‡æ¡ˆã€Logo é¡¯ç¤ºã€çé …åç¨±/é€²åº¦ã€é–ƒåç¸½æ™‚é•·èˆ‡å–®æ¬¡é¡¯ç¤ºæ™‚é–“
- **ä¸­çç•«é¢**ï¼šæ­å–œæ–‡å­—ã€Logoã€çé …åç¨±/é€²åº¦ã€éƒ¨é–€é¡¯ç¤ºã€å½©å¸¶ã€çµå°¾è¡¨æƒ…
- **è¨­å®šæª”**ï¼šå¯å„²å­˜èˆ‡é‚„åŸï¼Œå­˜æª”å…§å®¹æœƒç«‹å³åŒæ­¥å‰å°

### å¿«æ·éµ

- å‰å°æŠ•å½±è¦–çª—ï¼š`F11` åˆ‡æ›å…¨è¢å¹•ã€`Esc` é€€å‡ºå…¨è¢å¹•

## é‡è¦è¡Œç‚ºèªªæ˜

### æœªå®Œæˆæ´»å‹•æ¢å¾©

å•Ÿå‹•æ™‚è‹¥åµæ¸¬åˆ°æœªå®Œæˆçš„å‚™ä»½è³‡æ–™ï¼Œç³»çµ±æœƒè©¢å•æ˜¯å¦æ¢å¾©ä¸Šæ¬¡é€²åº¦ã€‚

### åå–®æ’å…¥åˆä½µ

äººå“¡åå–®æ”¯æ´ã€Œæ’å…¥é¡å¤–åå–®ã€ï¼Œç³»çµ±æœƒä»¥ã€Œå§“å + éƒ¨é–€ã€å»é‡ï¼Œé‡è¤‡è€…å°‡è¢«ç•¥éã€‚

### å¿«ç…§ç®¡ç†

å¿«ç…§ç®¡ç†ç›®å‰æä¾›**è¼‰å…¥/åˆªé™¤** `backup_*.xlsx` æª”æ¡ˆã€‚è‹¥éœ€å»ºç«‹å¿«ç…§ï¼Œå¯å°‡ `backup_state.xlsx` è¤‡è£½ä¸¦æ”¹åç‚º `backup_YYYY-MM-DDTHH-MM.xlsx` å¾Œæ”¾å› `backup/`ã€‚

### æ’é™¤å·²ä¸­çè€…

- å…¨åŸŸè¨­å®šå¯æŒ‡å®šã€Œæ–°å¢çé …æ™‚çš„é è¨­å€¼ã€
- æ¯å€‹çé …å¯ç¨ç«‹åˆ‡æ›æ˜¯å¦æ’é™¤å·²ä¸­çè€…

## å¸¸è¦‹å®¢è£½åŒ–èª¿æ•´ï¼ˆé–‹ç™¼è€…ï¼‰

ä»¥ä¸‹åˆ—å‡ºè¼ƒå¸¸è¢«èª¿æ•´çš„é …ç›®èˆ‡å°æ‡‰æª”æ¡ˆä½ç½®ï¼Œæ–¹ä¾¿ä¾éœ€æ±‚ä¿®æ”¹ï¼š

| èª¿æ•´é …ç›® | æª”æ¡ˆä½ç½® | èªªæ˜ |
|---|---|---|
| å€’æ•¸ç§’æ•¸ | `src/constants/lottery.ts` | èª¿æ•´ `REVEAL_COUNTDOWN_SECONDS`ï¼ˆ`REVEAL_COUNTDOWN_MS` æœƒè‡ªå‹•é€£å‹•ï¼‰ |
| å€’æ•¸ç•«é¢æ–‡æ¡ˆ/çµæ§‹ | `src/components/display/RevealCountdown.tsx` | å€’æ•¸éšæ®µçš„æ¨™é¡Œã€æ–‡æ¡ˆèˆ‡å‘ˆç¾å…§å®¹ |
| å‰å°è¦–è¦ºæ¨£å¼ | `src/components/display/DisplayScreen.css` | å€’æ•¸ã€æŠ½çã€æ­æ›‰ç­‰å‰å°ç•«é¢æ¨£å¼ |
| å¾…æ©Ÿç•«é¢æ¨™é¡Œ/å‰¯æ¨™ | `src/components/display/StandbyScreen.tsx` | å¾…æ©Ÿç•«é¢æ¨™é¡Œèˆ‡æç¤ºæ–‡å­— |
| ä¸­çæ­æ›‰æ–‡æ¡ˆ/ç´™èŠ± | `src/components/display/WinnerReveal.tsx` | ç¥è³€æ–‡æ¡ˆã€ç´™èŠ±é¡è‰²èˆ‡æ•¸é‡ |
| æŠ½çæµç¨‹èˆ‡ç¯€å¥ | `src/components/control/DrawControl.tsx` | æŠ½ç/ç¢ºèª/é‡æŠ½çš„æµç¨‹ç¯€å¥èˆ‡è¡Œç‚º |
| é è¨­æŠ½çæ¨¡å¼ | `src/stores/lottery-store.ts` | `drawMode`ã€`customDrawCount`ã€`globalExcludeWinners` ç­‰é è¨­å€¼ |
| Excel æ¬„ä½è¦å‰‡ | `src/utils/excel-handler.ts` | åŒ¯å…¥æ¬„ä½å‘½åèˆ‡åŒ¯å‡ºå…§å®¹çš„å®šç¾© |
| å‚™ä»½/å¿«ç…§æª”å | `src/utils/backup-manager.ts` | å‚™ä»½/å¿«ç…§æª”æ¡ˆå‘½åèˆ‡å­˜æª”æ–¹å¼ |
| å‰å°é¡¯ç¤ºè¨­å®šå­˜æª” | `src/utils/display-settings-storage.ts` | å„²å­˜/è®€å–/æ¸…é™¤ç•«é¢è¨­å®š |
| å…¨åŸŸè‰²ç³»èˆ‡å­—é«” | `src/index.css` | CSS è®Šæ•¸ã€å­—é«”èˆ‡å…±ç”¨æ¨£å¼ |
| é è¨­éŸ³æ•ˆ | `src/utils/sound-manager.ts` | å…§å»ºéŸ³æ•ˆèˆ‡æ’­æ”¾è¡Œç‚ºè¨­å®š |

## æŠ€è¡“æ¶æ§‹

- **Electron**ï¼šæ¡Œé¢æ‡‰ç”¨æ¡†æ¶
- **React + TypeScript**ï¼šå‰ç«¯ UI
- **Zustand**ï¼šç‹€æ…‹ç®¡ç†
- **xlsx**ï¼šExcel è®€å¯«
- **@dnd-kit**ï¼šæ‹–æ‹‰æ’åº

## è³‡æ–™å„²å­˜ä½ç½®

å‚™ä»½æª”æ¡ˆèˆ‡é¡¯ç¤ºè¨­å®šï¼ˆå« Logo/èƒŒæ™¯/éŸ³æ•ˆï¼‰éƒ½æœƒå­˜æ”¾åœ¨ `backup` è³‡æ–™å¤¾ï¼š
- é–‹ç™¼ç’°å¢ƒï¼šå°ˆæ¡ˆæ ¹ç›®éŒ„ä¸‹çš„ `backup/`
- æ‰“åŒ…å¾Œï¼ˆå¯æ”œç‰ˆæˆ–æœ‰å¯«å…¥æ¬Šé™æ™‚ï¼‰ï¼š`exe` åŒå±¤çš„ `backup/`
- æ‰“åŒ…å¾Œï¼ˆ`exe` åŒå±¤ä¸å¯å¯«å…¥æ™‚ï¼‰ï¼šå›é€€åˆ°å•Ÿå‹•æ™‚çš„å·¥ä½œç›®éŒ„ `backup/`ï¼ˆ`process.cwd()`ï¼‰

> å»ºè­°ä½¿ç”¨ portable ç‰ˆä¸¦æ”¾åœ¨æ¡Œé¢æˆ– D æ§½ï¼Œä½¿ç”¨è€…å¯ç›´æ¥å‚™ä»½æˆ–æ›¿æ› `backup` è³‡æ–™å¤¾å…§å®¹ã€‚

### å‚™ä»½æª”æ¡ˆå…§å®¹

- `backup_state.xlsx`ï¼šå®Œæ•´å‚™ä»½ï¼ˆçé … / ä¸­ç / æŠ½çæ±  / å…¨å“¡åå–®ï¼‰
- `backup_participants.xlsx` / `backup_prizes.xlsx` / `backup_winners.xlsx`ï¼šæ‹†åˆ†å‚™ä»½
- `backup_YYYY-MM-DDTHH-MM.xlsx`ï¼šæ™‚é–“æˆ³å¿«ç…§
- `display_settings.json`ï¼šå‰å°ç•«é¢è¨­å®šèˆ‡è‡ªè¨‚ç´ æ
